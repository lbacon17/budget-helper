{% extends "base.html" %}

{% block content %}

{% if expenses | length >=1 %}
    <h1 class="center-align">My Expenses</h1>

    <h6 class="center-align">Here are your expenses for each month below.</h4>

    <div class="container expenses-container center-align">
        <ul class="collapsible">
            {% for month in months %}
                <li>
                    <div class="collapsible-header">
                        <div class="col-12">
                            <h5>{{ month.month_name }}</h5>
                        </div>
                    </div>
                    <div class="collapsible-body">
                            {% for expense in expenses %}
                                {% if expense.date == month.month_name %}
                                <div class="row expense-record">
                                    <div class="col s6 m3">
                                        <span>{{ expense.date }}</span>
                                    </div>
                                    <div class="col s6 m3">
                                        <span>{{ expense.category_name }}</span>
                                    </div>
                                    <div class="col s6 m3">
                                        <span>{{ expense.expense_description }}</span>
                                    </div>
                                    <div class="col s6 m3">
                                        <span>GBP {{ expense.expense_amount }}</span>
                                        <a href="{{ url_for('delete_expense', expense_id=expense._id ) }}">                        
                                            <i class="fas fa-trash-alt red-text right"></i>
                                        </a>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col s12">
                                        {% set totals = [] %}
                                        {% for expense in expenses %}
                                            {% set amount = expense.expense_amount | float %}
                                            {% if totals.append(amount) %}
                                                <span>{{ totals }}</span>
                                            {% endif %}
                                        {% endfor %}
                                        <span>GBP {{ totals | sum }}</span>
                                    </div>
                                </div>
                                {% else %}
                                <div class="row expense-record">
                                    <div class="col s6 m3">
                                        <span>You have no expenses for {{ month.month_name }} yet.</span>
                                    </div>
                                </div>
                                {% endif %}
                            {% endfor %}
                    </div>
                </li>
            {% endfor %}
        </ul>
    </div>
    {% else %}
    <div class="row">
        <div class="col s12">
            <h4>You have no expenses yet.</h4>
        </div>
    </div>
    <div class="row">
        <div class="col s12">
            <a href="{{ url_for('new_expense') }}" class="btn-large green">Create Expense</a>
        </div>
    </div>
{% endif %}

{% endblock %}